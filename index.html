<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hylink Finance</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">

  <!-- Gallery Section -->
  <section id="gallerySection" class="py-10 bg-white">
    <div class="max-w-6xl mx-auto px-6">
      <h2 class="text-2xl font-bold text-center mb-6">Gallery</h2>
      <div id="slider" class="flex overflow-x-auto no-scrollbar"></div>
    </div>
  </section>

  <!-- Advert Section -->
  <section id="advert" class="py-10 bg-gray-200">
    <div class="max-w-6xl mx-auto px-6">
      <h2 class="text-2xl font-bold text-center mb-6">Advertisement</h2>
      <div class="relative w-full overflow-hidden rounded-lg shadow-lg group">
        <div id="advertSlides" class="flex transition-transform duration-700 ease-in-out"></div>
      </div>
    </div>
  </section>

  <!-- Lightbox Modal -->
  <div id="lightbox" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50">
    <span id="closeLightbox" class="absolute top-4 right-6 text-white text-4xl cursor-pointer">&times;</span>

    <!-- Prev Button -->
    <button id="prevBtn" class="absolute left-6 text-white text-4xl font-bold px-3 py-1 bg-black/40 rounded-full hover:bg-black/70">
      &#10094;
    </button>

    <img id="lightboxImg" src="" class="max-h-[90%] max-w-[90%] rounded shadow-lg" />

    <!-- Next Button -->
    <button id="nextBtn" class="absolute right-6 text-white text-4xl font-bold px-3 py-1 bg-black/40 rounded-full hover:bg-black/70">
      &#10095;
    </button>
  </div>

  <script>
    const username = "D-Oracle1";  
    const repo = "Hylink-Finance"; 
    const branch = "main";         

    // Fetch images from a folder
    async function fetchImagesFromGitHub(folder) {
      const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${folder}?ref=${branch}`;
      try {
        const response = await fetch(apiUrl);
        if (!response.ok) throw new Error("GitHub API error");
        return await response.json();
      } catch (error) {
        console.error("Error fetching images:", error);
        return [];
      }
    }

    // Gallery
    async function initGallery() {
      const files = await fetchImagesFromGitHub("img");
      const imageList = [];
      const slider = document.getElementById("slider");

      files.forEach(file => {
        if (file.type === "file" && /\.(jpg|jpeg|png|gif)$/i.test(file.name)) {
          imageList.push(file.download_url);
        }
      });

      let currentIndex = 0;
      const doubledImages = [...imageList, ...imageList];

      doubledImages.forEach((src, index) => {
        const imgEl = document.createElement("img");
        imgEl.src = src;
        imgEl.className = "h-48 w-auto rounded-lg shadow mx-2 cursor-pointer hover:scale-105 transition";
        slider.appendChild(imgEl);

        imgEl.addEventListener("click", () => openModal(index % imageList.length, imageList));
      });

      // Lightbox controls
      const lightbox = document.getElementById("lightbox");
      const lightboxImg = document.getElementById("lightboxImg");
      const closeBtn = document.getElementById("closeLightbox");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");

      function openModal(index, images) {
        currentIndex = index;
        showImage();
        lightbox.classList.remove("hidden");
        lightbox.classList.add("flex");
      }

      function showImage() {
        lightboxImg.src = imageList[currentIndex];
      }

      prevBtn.addEventListener("click", () => {
        currentIndex = (currentIndex - 1 + imageList.length) % imageList.length;
        showImage();
      });

      nextBtn.addEventListener("click", () => {
        currentIndex = (currentIndex + 1) % imageList.length;
        showImage();
      });

      closeBtn.addEventListener("click", () => {
        lightbox.classList.add("hidden");
        lightbox.classList.remove("flex");
      });

      lightbox.addEventListener("click", e => {
        if (e.target === lightbox) {
          lightbox.classList.add("hidden");
          lightbox.classList.remove("flex");
        }
      });

      document.addEventListener("keydown", e => {
        if (lightbox.classList.contains("flex")) {
          if (e.key === "Escape") {
            lightbox.classList.add("hidden");
            lightbox.classList.remove("flex");
          } else if (e.key === "ArrowLeft") {
            currentIndex = (currentIndex - 1 + imageList.length) % imageList.length;
            showImage();
          } else if (e.key === "ArrowRight") {
            currentIndex = (currentIndex + 1) % imageList.length;
            showImage();
          }
        }
      });
    }

    // Advert
    async function initAdvert() {
      const files = await fetchImagesFromGitHub("advert");
      const advertList = [];
      const advertSlides = document.getElementById("advertSlides");

      files.forEach(file => {
        if (file.type === "file" && /\.(jpg|jpeg|png|gif)$/i.test(file.name)) {
          advertList.push(file.download_url);
        }
      });

      advertList.forEach(src => {
        const imgEl = document.createElement("img");
        imgEl.src = src;
        imgEl.loading = "lazy";
        imgEl.className = "w-full h-64 md:h-80 object-cover flex-shrink-0";
        advertSlides.appendChild(imgEl);
      });

      // Clone first for infinite loop
      if (advertSlides.children.length > 0) {
        const clone = advertSlides.children[0].cloneNode(true);
        advertSlides.appendChild(clone);
      }

      let currentIndex = 0;
      const slideDurationMs = 4000;
      const transitionDurationMs = 700;

      function showNextSlide() {
        currentIndex++;
        advertSlides.style.transform = `translateX(-${currentIndex * 100}%)`;

        if (currentIndex === advertList.length) {
          setTimeout(() => {
            advertSlides.style.transition = "none";
            currentIndex = 0;
            advertSlides.style.transform = `translateX(0%)`;
            void advertSlides.offsetWidth;
            advertSlides.style.transition = "transform 0.7s ease-in-out";
          }, transitionDurationMs);
        }
      }

      setInterval(showNextSlide, slideDurationMs);
    }

    // Initialize both sections
    initGallery();
    initAdvert();
  </script>
</body>
</html>
